{% extends "base_search.html" %}
{% from "macros.html" import if_not_empty %}

{% block head %}
    <link type="text/css"
          href="{{ url_for('static', filename='preview.css') }}"
          rel="stylesheet">
{% endblock %}

{% block body %}
    {#    <script>#}
    {#        function copy(text) {#}
    {#            let input = document.createElement('input');#}
    {#            input.setAttribute('value', text);#}
    {#            document.body.appendChild(input);#}
    {#            input.select();#}
    {#            let result = document.execCommand('copy');#}
    {#            document.body.removeChild(input);#}
    {#            return result;#}
    {#        }#}
    {#    </script>#}

    <div class="preview-content limited-width">

        {% if meta.previous %}
            <a href="/preview/{{ meta.previous }}"
               class="button preview-swipe">Previous</a>
        {% else %}
            <a class="preview-swipe">&nbsp;</a>
        {% endif %}

        <div>
            <a href="{{ url_for('serve_content', filename=meta.path_to_content) }}">
                <img src="{{ url_for('serve_content', filename=meta.path_to_preview) }}"
                     alt="Click here for full resolution"/>
            </a>
        </div>

        {% if meta.next %}
            <a href="/preview/{{ meta.next }}"
               class="button preview-swipe">Next</a>
        {% else %}
            <a class="preview-swipe">&nbsp;</a>
        {% endif %}
    </div>

    <br>

    <div class="preview-content limited-width">
        <table class="preview-table">
            {% if meta.author or meta.origin_url %}
                <tr>
                    <th colspan="2">Origin</th>
                </tr>
                {% if meta.origin_url %}
                    <tr>
                        <td>Url</td>
                        <td>
                            <a href="{{ meta.origin_url }}">Link</a>
                        </td>
                    </tr>
                {% endif %}

                {% if meta.author %}
                    <tr>
                        <td>Author</td>
                        <td>
                            {{ meta.author }}
                        </td>
                    </tr>
                {% endif %}

                {% if meta.author_url %}
                    <tr>
                        <td>Profile</td>
                        <td>
                            <a href="{{ meta.author_url }}">Link</a>
                        </td>
                    </tr>
                {% endif %}
            {% endif %}

            <tr>
                <th colspan="2">Information</th>
            </tr>

            <td>Size</td>
            <td>{{ byte_count_to_text(meta.size) }}</td>

            {{ if_not_empty('Width', meta.width, ' px') }}
            {{ if_not_empty('Height', meta.height, ' px') }}
            {{ if_not_empty('Resolution', meta.resolution, ' Mpx') }}
            {{ if_not_empty('Media type', meta.type) }}
            {{ if_not_empty('Registered on', meta.registered_on) }}
            {{ if_not_empty('Registered by', meta.registered_by) }}

            {%- if tags %}
                <tr>
                    <th colspan="2">Tags</th>
                </tr>
                <tr>
                    <td colspan="2">
                        <ol>
                            {%- for tag in tags %}
                                <li>
                                    <a href="{{ url_for('search') + web_query.replace(q=tag)|string }}">{{ tag }}</a>
                                </li>
                            {% endfor -%}
                        </ol>
                    </td>
                </tr>
            {% endif -%}

        </table>
    </div>

    <br>

{% endblock %}